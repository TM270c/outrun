<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Straight Track — 2.5D + Drift + Fog + Cliffs + Sprites + Guardrails</title>
    <style>
      html,
      body {
        margin: 0;
        background: #0f1a0f;
        color: #f4f4f4;
        font-family: system-ui, Arial, sans-serif;
      }
      .wrap {
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
      }
      .stack {
        position: relative;
        width: 1024px;
        height: 768px;
        border: 1px solid #1a1f1a;
        background: #000;
        overflow: hidden;
      }
      #outrun {
        position: absolute;
        left: 0;
        top: 0;
        width: 1024px;
        height: 768px;
        image-rendering: pixelated;
        image-rendering: crisp-edges;
        background: #000;
      }
      #sideOverlay {
        position: absolute;
        left: 0;
        top: 0;
        width: 1024px;
        height: 768px;
        background: transparent;
        pointer-events: none;
      }
      #hudMatte {
        position: absolute;
        left: 0;
        top: 0;
        width: 1024px;
        height: 768px;
        image-rendering: pixelated;
        image-rendering: crisp-edges;
        background: transparent;
        pointer-events: none;
      }
      #appMenuLayer {
        position: absolute;
        inset: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        background: rgba(0, 0, 0, 0.55);
        color: #f4f4f4;
        pointer-events: none;
        transition: opacity 0.2s ease;
      }
      #appMenuLayer.is-hidden {
        opacity: 0;
        pointer-events: none;
      }
      #appMenuLayer .menu-panel {
        width: 100%;
        height: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 32px;
        box-sizing: border-box;
        pointer-events: none;
      }
      #appMenuLayer .screen {
        pointer-events: auto;
        width: min(420px, 100%);
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 12px;
        text-align: center;
      }
      #appMenuLayer .screen-full {
        width: 100%;
        max-width: none;
        gap: 16px;
      }
      #appMenuLayer[data-mode='attract'] {
        background: #000;
      }
      #appMenuLayer[data-mode='attract'] .screen {
        text-transform: none;
        letter-spacing: normal;
      }
      #appMenuLayer .screen-title {
        margin: 0;
        font-size: 22px;
        font-weight: 600;
      }
      #appMenuLayer .screen-subtitle {
        margin: 0;
        font-size: 13px;
        color: rgba(255, 255, 255, 0.65);
      }
      #appMenuLayer .menu-list {
        list-style: none;
        margin: 8px 0 0;
        padding: 0;
        width: 100%;
        display: flex;
        flex-direction: column;
        gap: 6px;
      }
      #appMenuLayer .menu-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 6px 8px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.25);
        color: rgba(255, 255, 255, 0.7);
      }
      #appMenuLayer .menu-item:last-child {
        border-bottom: none;
      }
      #appMenuLayer .menu-item.is-selected {
        color: #fff;
        font-weight: 600;
      }
      #appMenuLayer .menu-label {
        flex: 1;
        text-align: left;
      }
      #appMenuLayer .menu-item.is-selected .menu-label::before {
        content: '› ';
        color: #fff;
      }
      #appMenuLayer .menu-value {
        font-size: 12px;
        color: rgba(255, 255, 255, 0.55);
      }
      #appMenuLayer .screen-hint {
        margin: 4px 0 0;
        font-size: 12px;
        color: rgba(255, 255, 255, 0.5);
      }
      #appMenuLayer .screen-vehicle {
        width: min(520px, 100%);
        gap: 16px;
      }
      #appMenuLayer .vehicle-select-preview {
        width: 100%;
        max-width: 320px;
        aspect-ratio: 1;
        background: rgba(0, 0, 0, 0.35);
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 12px;
        border-radius: 12px;
        box-shadow: 0 0 24px rgba(0, 0, 0, 0.4) inset;
      }
      #appMenuLayer .vehicle-select-image {
        width: 100%;
        aspect-ratio: 1;
        display: block;
        background-repeat: no-repeat;
        background-position: 0% 0%;
        background-size: calc(var(--vehicle-preview-columns, 1) * 100%)
          calc(var(--vehicle-preview-rows, 1) * 100%);
        image-rendering: pixelated;
        image-rendering: crisp-edges;
        filter: drop-shadow(0 6px 12px rgba(0, 0, 0, 0.6));
      }
      #appMenuLayer .vehicle-select-name {
        margin: 0;
        font-size: 20px;
        font-weight: 600;
      }
      #appMenuLayer .vehicle-select-counter {
        margin: 0;
        font-size: 12px;
        color: rgba(255, 255, 255, 0.55);
      }
      #appMenuLayer .vehicle-select-description {
        margin: 0;
        font-size: 13px;
        color: rgba(255, 255, 255, 0.7);
      }
      #appMenuLayer .screen-message {
        margin: 4px 0 0;
        font-size: 13px;
        color: rgba(255, 255, 255, 0.75);
      }
      #appMenuLayer .leaderboard-list {
        list-style: none;
        margin: 8px 0 0;
        padding: 0;
        width: 100%;
        display: flex;
        flex-direction: column;
        gap: 4px;
        font-size: 13px;
      }
      #appMenuLayer .leaderboard-item {
        display: flex;
        justify-content: space-between;
        gap: 8px;
        padding: 4px 0;
        border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        color: rgba(255, 255, 255, 0.7);
      }
      #appMenuLayer .leaderboard-item:last-child {
        border-bottom: none;
      }
      #appMenuLayer .leaderboard-item.is-highlight {
        color: #fff;
        font-weight: 600;
      }
      #appMenuLayer .leaderboard-rank {
        min-width: 28px;
        text-align: left;
        color: rgba(255, 255, 255, 0.6);
      }
      #appMenuLayer .leaderboard-name {
        flex: 1;
        text-align: left;
      }
      #appMenuLayer .leaderboard-score {
        text-align: right;
        min-width: 100px;
      }
      #appMenuLayer .screen-attract {
        gap: 12px;
      }
      #appMenuLayer .screen-attract::after {
        content: 'Press any key to start';
        font-size: 13px;
        text-transform: uppercase;
        letter-spacing: 0.08em;
        color: rgba(255, 255, 255, 0.65);
      }
      #appMenuLayer .attract-video {
        width: 100%;
        height: 100%;
        object-fit: cover;
        opacity: 0.65;
      }
      #appMenuLayer .screen-score-title {
        margin: 0;
        font-size: 22px;
        font-weight: 600;
      }
      #appMenuLayer .screen-score-time {
        font-size: 28px;
        font-weight: 600;
      }
      #appMenuLayer .screen-score-note {
        margin: 0;
        font-size: 12px;
        color: rgba(255, 255, 255, 0.5);
      }
      #appMenuLayer .name-entry {
        display: flex;
        gap: 8px;
        justify-content: center;
      }
      #appMenuLayer .name-entry-letter {
        min-width: 36px;
        padding: 6px 0;
        border: 1px solid rgba(255, 255, 255, 0.35);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 18px;
      }
      #appMenuLayer .name-entry-letter.is-active {
        border-color: #fff;
      }
      #appMenuLayer .name-entry-letter.is-locked {
        border-color: rgba(180, 255, 200, 0.7);
        color: rgba(200, 255, 220, 0.9);
      }
      .race-message {
        position: absolute;
        left: 50%;
        top: 40%;
        transform: translate(-50%, -50%) scale(0.5);
        font-size: 80px;
        font-weight: 900;
        color: #fff;
        text-shadow: 0 4px 0 #000, 0 0 20px rgba(0,0,0,0.5);
        text-transform: uppercase;
        font-style: italic;
        pointer-events: none;
        opacity: 0;
        transition: opacity 0.1s, transform 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      }
      .race-message.is-visible {
        opacity: 1;
        transform: translate(-50%, -50%) scale(1);
      }
      .ui {
        position: fixed;
        left: 50%;
        top: 10px;
        transform: translateX(-50%);
        font: 12px system-ui, Arial;
        background: #000c;
        color: #fff;
        padding: 6px 10px;
        border-radius: 10px;
      }
      .notes-sidebar {
        width: 240px;
        margin-right: 40px;
        padding: 20px;
        background: rgba(0, 20, 0, 0.5);
        border: 1px solid rgba(100, 255, 100, 0.2);
        border-radius: 8px;
        font-size: 13px;
        line-height: 1.5;
        color: #aaddaa;
      }
      .notes-sidebar h3 {
        margin: 0 0 12px 0;
        font-size: 14px;
        text-transform: uppercase;
        letter-spacing: 0.1em;
        color: #fff;
        border-bottom: 1px solid rgba(100, 255, 100, 0.3);
        padding-bottom: 8px;
      }
      .notes-sidebar ul { margin: 0; padding-left: 16px; }
      .notes-sidebar li { margin-bottom: 8px; }
    </style>
  </head>
  <body>
    <div class="wrap">
      <div class="notes-sidebar">
        <h3>Future Work</h3>
        <ul>
          <li><strong>Performance:</strong> Refactor GLRenderer to use batching (reduce draw calls).</li>
          <li><strong>Assets:</strong> Combine textures into a single atlas to support batching.</li>
        </ul>
      </div>
      <div class="stack">
        <canvas id="outrun" width="512" height="384" title="2.5D view (WebGL)"></canvas>
        <canvas id="sideOverlay" width="1024" height="768" title="Side overlay (B to toggle)"></canvas>
        <canvas id="hudMatte" width="512" height="384" title="HUD reset matte"></canvas>
        <div id="raceMessage" class="race-message"></div>
        <div id="appMenuLayer" class="is-hidden">
          <div class="menu-panel"></div>
        </div>
      </div>
    </div>
    <div class="ui">←/→ steer · ↑ throttle · ↓ brake · SPACE hop/select · R reset · P pause · B toggle overlay</div>
    <script>
      // This script dynamically loads all your game's JavaScript files
      // and adds a unique timestamp to each one to defeat the browser cache during development.
      (function () {
        const timestamp = Date.now();
        const scripts = [
          'src/config.js',
          'src/math.js',
          'src/gl/renderer.js',
          'src/world.js',
          'src/sprite-catalog.js',
          'src/gameplay.js',
          'src/render-debug.js',
          'src/render.js',
          'src/ui/screens.js',
          'src/app.js',
        ];
        scripts.forEach((src) => {
          document.write(`<script src="${src}?t=${timestamp}"><\/script>`);
        });
        // The bootstrap script is a module and must be loaded last.
        document.write(`<script type="module" src="src/bootstrap.js?t=${timestamp}"><\/script>`);
      })();
    </script>
  </body>
</html>
