<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Straight Track — 2.5D + Drift + Fog + Cliffs + Sprites + Guardrails</title>
  <style>
    html,body{margin:0;background:#0f1a0f}
    .wrap{display:flex;gap:16px;justify-content:center;align-items:center;height:100vh}
    .stack{position:relative;width:1024px;height:768px;border:1px solid #2a2a2a;background:#ffffff;overflow:hidden}
    #outrun{position:absolute;left:0;top:0;width:1024px;height:768px;image-rendering:pixelated;image-rendering:crisp-edges;background:#ffffff}
    #sideOverlay{position:absolute;left:0;top:0;width:1024px;height:768px;background:transparent;pointer-events:none}
    #hudMatte{position:absolute;left:0;top:0;width:1024px;height:768px;image-rendering:pixelated;image-rendering:crisp-edges;background:transparent;pointer-events:none}
    #appMenuLayer{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;color:#f6fbff;font-family:'Eurostile',system-ui,Arial,sans-serif;pointer-events:none;transition:opacity .35s ease,transform .45s ease;opacity:1;transform:scale(1)}
    #appMenuLayer.is-hidden{opacity:0;pointer-events:none;transform:scale(1.02)}
    #appMenuLayer .menu-bg{position:absolute;inset:0;background:radial-gradient(circle at 50% 40%,rgba(36,52,86,.45),rgba(10,12,24,.9));backdrop-filter:blur(6px);mix-blend-mode:screen;opacity:.9;transition:opacity .45s ease}
    #appMenuLayer.is-hidden .menu-bg{opacity:0}
    #appMenuLayer .menu-panel{position:relative;min-width:340px;max-width:520px;padding:40px 48px;border-radius:28px;background:linear-gradient(160deg,rgba(18,26,42,.82),rgba(9,12,24,.92));box-shadow:0 28px 80px rgba(0,0,0,.55),0 0 0 1px rgba(120,160,255,.08);pointer-events:auto;overflow:hidden}
    #appMenuLayer .menu-panel::before{content:'';position:absolute;inset:12px;border-radius:20px;border:1px solid rgba(120,160,255,.18);pointer-events:none;opacity:.7}
    #appMenuLayer .menu-panel-inner{position:relative;z-index:1;display:flex;flex-direction:column;gap:28px}
    #appMenuLayer .menu-title{text-transform:uppercase;letter-spacing:.32em;font-size:28px;text-align:center;color:#d1e7ff;text-shadow:0 4px 18px rgba(0,0,0,.45)}
    #appMenuLayer .menu-subtitle{text-align:center;font-size:14px;letter-spacing:.2em;text-transform:uppercase;color:rgba(173,208,255,.65)}
    #appMenuLayer .menu-body{display:flex;flex-direction:column;gap:18px}
    #appMenuLayer .menu-options{list-style:none;margin:0;padding:0;display:flex;flex-direction:column;gap:12px}
    #appMenuLayer .menu-option{position:relative;padding:12px 20px;border-radius:16px;background:rgba(22,32,54,.65);border:1px solid rgba(108,152,255,.18);font-size:18px;letter-spacing:.08em;text-transform:uppercase;display:flex;justify-content:space-between;align-items:center;color:#b7c8ff;transition:transform .2s ease,background .2s ease,color .2s ease,border .2s ease;box-shadow:0 10px 24px rgba(0,0,0,.25)}
    #appMenuLayer .menu-option::after{content:'';position:absolute;inset:0;border-radius:inherit;border:1px solid rgba(255,255,255,.08);mix-blend-mode:screen;opacity:0;transition:opacity .3s ease}
    #appMenuLayer .menu-option.is-selected{background:linear-gradient(120deg,rgba(108,152,255,.35),rgba(58,232,255,.45));color:#fff;border-color:rgba(156,230,255,.65);transform:translateX(10px) scale(1.02)}
    #appMenuLayer .menu-option.is-selected::after{opacity:1}
    #appMenuLayer .menu-option-label{flex:1}
    #appMenuLayer .menu-option-value{font-size:14px;letter-spacing:.2em;color:rgba(255,255,255,.7)}
    #appMenuLayer .menu-footer{text-align:center;font-size:12px;letter-spacing:.24em;text-transform:uppercase;color:rgba(196,220,255,.58)}
    #appMenuLayer .leaderboard-list{list-style:none;margin:0;padding:0;display:flex;flex-direction:column;gap:10px}
    #appMenuLayer .leaderboard-row{display:flex;justify-content:space-between;padding:10px 16px;border-radius:14px;background:rgba(20,30,48,.6);border:1px solid rgba(84,124,220,.18);color:#d4e6ff;font-size:16px;letter-spacing:.12em;text-transform:uppercase}
    #appMenuLayer .leaderboard-row-rank{color:rgba(96,192,255,.8);margin-right:16px}
    #appMenuLayer .leaderboard-row.is-player{background:linear-gradient(120deg,rgba(82,196,255,.35),rgba(168,122,255,.4));color:#fff;border-color:rgba(180,228,255,.7);box-shadow:0 0 24px rgba(82,196,255,.35)}
    #appMenuLayer .leaderboard-row.is-ellipsis{justify-content:center;color:rgba(212,230,255,.4);font-style:italic;letter-spacing:.5em}
    #appMenuLayer .menu-message{text-align:center;font-size:14px;letter-spacing:.14em;text-transform:uppercase;color:rgba(200,220,255,.6)}
    #appMenuLayer .menu-panel[data-mode="attract"]{max-width:720px;padding:24px 24px 32px;border-radius:30px;background:rgba(6,8,16,.92);}
    #appMenuLayer .menu-panel[data-mode="attract"]::before{display:none}
    #appMenuLayer .menu-panel[data-mode="attract"] .menu-panel-inner{gap:18px;padding:0;background:transparent}
    #appMenuLayer .menu-panel-inner.is-attract{gap:18px}
    #appMenuLayer .attract-video-wrap{position:relative;overflow:hidden;border-radius:24px;box-shadow:0 18px 60px rgba(0,0,0,.55)}
    #appMenuLayer .attract-video{width:100%;height:auto;display:block;background:#02040a}
    #appMenuLayer .attract-overlay{position:absolute;inset:0;display:flex;align-items:flex-end;justify-content:space-between;padding:20px 28px;background:linear-gradient(180deg,rgba(2,4,10,0) 0%,rgba(2,4,10,.8) 100%);color:#c8ddff;letter-spacing:.28em;text-transform:uppercase;font-size:12px}
    #appMenuLayer .attract-title{font-size:24px;letter-spacing:.36em;text-transform:uppercase;text-align:center;color:#d1e7ff}
    #appMenuLayer .race-complete-score{font-size:24px;text-align:center;color:#8be4ff;letter-spacing:.24em;text-transform:uppercase;text-shadow:0 0 24px rgba(34,196,255,.45)}
    #appMenuLayer .name-entry{display:flex;justify-content:center;gap:18px}
    #appMenuLayer .name-entry-letter{width:68px;height:68px;border-radius:18px;border:2px solid rgba(104,156,255,.4);display:flex;align-items:center;justify-content:center;font-size:36px;letter-spacing:.3em;text-transform:uppercase;color:#c5d8ff;background:rgba(22,32,54,.6);box-shadow:0 16px 36px rgba(0,0,0,.3);transition:transform .2s ease,border .2s ease,color .2s ease}
    #appMenuLayer .name-entry-letter.is-active{border-color:rgba(140,210,255,.8);transform:translateY(-6px) scale(1.05);color:#fff;background:linear-gradient(150deg,rgba(108,152,255,.6),rgba(58,232,255,.45))}
    #appMenuLayer .name-entry-letter.is-locked{border-color:rgba(132,214,156,.7);color:#d9ffe5}
    #appMenuLayer .race-complete-message{text-align:center;color:rgba(196,220,255,.7);letter-spacing:.18em;text-transform:uppercase;font-size:13px}
    #appMenuLayer .menu-panel-inner.is-race-complete{gap:22px}
    #appMenuLayer .menu-panel[data-mode="raceComplete"] .menu-footer{letter-spacing:.18em}
    #appMenuLayer .menu-panel[data-mode="raceComplete"]{max-width:560px}
    .ui{position:fixed;left:50%;top:10px;transform:translateX(-50%);font:12px system-ui,Arial;background:#000c;color:#fff;padding:6px 10px;border-radius:10px}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="stack">
      <canvas id="outrun" width="512" height="384" title="2.5D view (WebGL)"></canvas>
      <canvas id="sideOverlay" width="1024" height="768" title="Side overlay (B to toggle)"></canvas>
      <canvas id="hudMatte" width="512" height="384" title="HUD reset matte"></canvas>
      <div id="appMenuLayer" class="is-hidden">
        <div class="menu-bg"></div>
        <div class="menu-panel"></div>
      </div>
    </div>
  </div>
  <div class="ui">←/→ steer · ↑ throttle · ↓ brake · SPACE hop/select · R reset · P pause · B toggle overlay</div>

  <!-- Only the split files, in order. No inline script block. -->
  <script src="src/config.js"></script>
  <script src="src/math.js"></script>
  <script src="src/gl/renderer.js"></script>
  <script src="src/world.js"></script>
  <script src="src/gameplay.js"></script>
  <script src="src/render.js"></script>
  <script src="src/app.js"></script>
  <script type="module" src="src/bootstrap.js"></script>
</body>
</html>
